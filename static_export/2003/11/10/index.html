<html>
<head>
  <title> 10 11 2003 | Jan's Home</title>
  <link rel="stylesheet" href="//l4x.org/l4x.css" type="text/css" media="screen" />
  <meta name="description" content="l4x.org - Jan Dittmer's Homepage" />
  <meta name="keywords" lang="de" content="elektronik, linux, Jan Dittmer, Jan, Dittmer, software, programmierung, blog, css, html, stylesheet, firefox,ipv6ident, ipv6, ip query firefox, ohg99, otto-hahn gymnasium, atmel, avr" />
  <meta name="ICBM" content="53.5467, 9.9783"/>
  <meta name="DC.title" content="l4x.org - Jan Dittmer's Homepage"/>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
  </style>
</head>
<body>
<div id="header">
<div class="logo">
<span style="">l</span>
<span style="color:#ffe450;">4</span>
<span style="color:#000000;">x</span>
<span style="">.</span>
<span style="">o</span>
<span style="">r</span>
<span style="">g</span>
</div>

<div id="alpha">
	alpha playground
</div>

<div id="userinfo">
        &nbsp;
</div>

</div> <!-- header -->

<div id="mainnav">
<ul class="hori">
<!-- internal links -->
<li><a href="https://l4x.org">Home</a></li>
<li><a href="https://l4x.org/projects">Projects</a></li>
<!-- external links -->
<!-- broken
<li><a href="http://home.l4x.org/pics/">Pics</a></li>
-->
<li><a href="https://dns.l4x.org">dns.</a></li>
<li><a href="https://git.l4x.org">git.</a></li>
<li><a href="https://l4x.org/k/">Kernel-Tests</a></li>
<li><a href="https://www.trixing.de">Trixing</a></li>
<li><a href="https://l4x.org/imprint.html">Imprint</a></li>
</ul>


</div>  <!-- mainnav end -->

<div id="content">

<p>10 11 2003</p>

<h2>Mon, 10 Nov 2003</h2>
<h3><a name="XFree_Xinerama_extension_hack">XFree_Xinerama_extension_hack</a></h3>
<div class="blosxomStory">


When installing my 3 monitor setup I quickly discovered that the native xfree xinerama extension is incompatible with nvidia twinview. You can only have either one. This leads to applications believing I have one 2560x1024 screen and one 1280x1024 screen. If I maximized windows they would always span two screens.
Therefore I spent a long time searching for a solution on google, but unfortunately there are a) few people with 3 monitors and b) no one had solved this. So I decided to patch the X server.
What I've done so far is to take programs/Xserver/Xext/panoramiX.c and fake the reply like this:


When installing my 3 monitor setup I quickly discovered that the native xfree xinerama extension is incompatible with nvidia twinview. You can only have either one. This leads to applications believing I have one 2560x1024 screen and one 1280x1024 screen. If I maximized windows they would always span two screens.
Therefore I spent a long time searching for a solution on google, but unfortunately there are a) few people with 3 monitors and b) no one had solved this. So I decided to patch the X server.
What I've done so far is to take programs/Xserver/Xext/panoramiX.c and fake the reply like this:<br /><pre>--- x/xc/programs/Xserver/Xext/panoramiX.c      2003-11-10 19:21:43.000000000 +0100<br />+++ x2/xc/programs/Xserver/Xext/panoramiX.c     2004-02-15 11:39:15.000000000 +0100<br />@@ -1026,7 +1030,8 @@<br /> <br />     rep.type = X_Reply;<br />     rep.sequenceNumber = client-&gt;sequence;<br />-    rep.number = (noPanoramiXExtension) ? 0 : PanoramiXNumScreens;<br />+   /* rep.number = (noPanoramiXExtension) ? 0 : PanoramiXNumScreens; */<br />+    rep.number = (noPanoramiXExtension) ? 0 : (PanoramiXNumScreens + 1);<br />     rep.length = rep.number * sz_XineramaScreenInfo &gt;&gt; 2;<br />     if (client-&gt;swapped) {<br />        register int n;<br />@@ -1040,11 +1045,17 @@<br />        xXineramaScreenInfo scratch;<br /><br />        int i;<br /> <br />-       for(i = 0; i &lt; PanoramiXNumScreens; i++) {<br />+       for(i = 0; i &lt; (PanoramiXNumScreens + 1); i++) {<br />+               /*<br />            scratch.x_org  = panoramiXdataPtr[i].x;<br />            scratch.y_org  = panoramiXdataPtr[i].y;<br />            scratch.width  = panoramiXdataPtr[i].width;<br />            scratch.height = panoramiXdataPtr[i].height;<br />+           */<br />+           scratch.x_org  = 1280 * i;<br />+           scratch.y_org  = 0;<br />+           scratch.width  = 1280;<br />+           scratch.height = 1024;<br /><br /></pre>
This is pretty specific, so I'm currently working my way through the code to make this configurable in the XF86Config-4.<br />
<br />
I also wrote a small test program:<br /><pre>#include &lt;<span class="start-tag">stdio</span><span class="attribute-name">.h</span>&gt;<br />#include &lt;<span class="start-tag">X11</span><span class="attribute-name">/extensions/Xinerama.h</span>&gt;<br /><br />int main() {<br />        XineramaScreenInfo *xsi;<br />        Display *dpy;<br />        int number;<br />        int i;<br />        dpy = XOpenDisplay(NULL);<br />        xsi = XineramaQueryScreens(dpy, &amp;<span class="entity">number</span>);<br />        for(i = 0; i &lt; number; i++) {<br />                printf(&quot;%d %d %d %d %d <br />&quot;, xsi[i].screen_number, xsi[i].x_org, <br />                        xsi[i].y_org, xsi[i].width, xsi[i].height);<br />        }<br />        return 1;<br />}</pre>
Output before the patch: (Columns are screennum x y width height):
<pre>0 0 0 2560 1024<br />2 2560 0 1280 1024<br /></pre>
Output after the patch:<pre>0 0 0 1280 1024 <br />
1 1280 0 1280 1024 <br />
2 2560 0 1280 1024 <br />
</pre>
Pretty successful.


<p class="posted">
  posted at 19:21 |
  path: <a href="https://l4x.org/unix" title="path">/unix</a> |
  <a href="https://l4x.org/unix/XFree_Xinerama_extension_hack.html" title="XFree_Xinerama_extension_hack">permanent link to this entry</a>
</p>
</div>

</div>


<div id="sidebar">
<h2>Random Photo</h2>
<div class="sidebarbox">
<script><!-- //http://code.google.com/apis/gdata/docs/json.html
var es = [];
function r() {
	var idx = Math.floor(Math.random()*es.length);
	var m = es[idx]['media$group'];
	var i = document.getElementById("i");
	document.getElementById("t").innerHTML = m['media$description']['$t'];
	i.src = m['media$thumbnail'][0]['url'];
	setTimeout("r();",10*1000);
}
function j(p) {
	es = p['feed']['entry'];
	r();
}
function picasa() {
	var url='https://picasaweb.google.com/data/feed/base/user/jan.dittmer?kind=photo&thumbsize=160c&access=public&alt=json&callback=j';
	var s = document.createElement('script');
	s.src = url; document.body.appendChild(s);
}
window.onload = picasa;
//--></script>
<a href="http://picasaweb.google.com/jan.dittmer"> <img id="i"> </a>
<div id="t"></div>
</div>

<h2>Archives</h2>
<div class="sidebarbox">
	<li><a href="https://l4x.org/2014/Dec">Dec 2014</a></li>
<li><a href="https://l4x.org/2014/Jun">Jun 2014</a></li>
<li><a href="https://l4x.org/2014/Mar">Mar 2014</a></li>
<li><a href="https://l4x.org/2014/Feb">Feb 2014</a></li>
<li><a href="https://l4x.org/2013/Nov">Nov 2013</a></li>
<li><a href="https://l4x.org/2013/Oct">Oct 2013</a></li>
<li><a href="https://l4x.org/2013/Sep">Sep 2013</a></li>
<li><a href="https://l4x.org/2011/Jan">Jan 2011</a></li>
<li><a href="https://l4x.org/2010/Nov">Nov 2010</a></li>
<li><a href="https://l4x.org/2010/Oct">Oct 2010</a></li>
<li><a href="https://l4x.org/2010/Aug">Aug 2010</a></li>
<li><a href="https://l4x.org/2010/Feb">Feb 2010</a></li>
<li><a href="https://l4x.org/2010/Jan">Jan 2010</a></li>
<li><a href="https://l4x.org/2009/Sep">Sep 2009</a></li>
<li><a href="https://l4x.org/2008/Nov">Nov 2008</a></li>
<li><a href="https://l4x.org/2008/Jun">Jun 2008</a></li>
<li><a href="https://l4x.org/2008/Apr">Apr 2008</a></li>
<li><a href="https://l4x.org/2007/Sep">Sep 2007</a></li>
<li><a href="https://l4x.org/2007/Mar">Mar 2007</a></li>
<li><a href="https://l4x.org/2006/Nov">Nov 2006</a></li>
<li><a href="https://l4x.org/2006/Sep">Sep 2006</a></li>
<li><a href="https://l4x.org/2006/Aug">Aug 2006</a></li>
<li><a href="https://l4x.org/2006/Jun">Jun 2006</a></li>
<li><a href="https://l4x.org/2005/Jun">Jun 2005</a></li>
<li><a href="https://l4x.org/2005/May">May 2005</a></li>
<li><a href="https://l4x.org/2004/May">May 2004</a></li>
<li><a href="https://l4x.org/2003/Nov">Nov 2003</a></li>
</div>

<h2>Feed</h2>
<div class="sidebarbox">
<a title="RSS" href="https://l4x.org/index.rss20"> RSS </a> /
<a title="ATOM" href="https://l4x.org/index.atom"> ATOM  </a>
</div>

</div><!-- sidebar end -->


<div id="license">
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
</div>
</body>
</html>
